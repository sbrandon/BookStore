<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC "-//Apache Software Foundation//DTD Struts Configuration 2.3//EN" "http://struts.apache.org/dtds/struts-2.3.dtd">
	
<struts>
    
    <constant name="struts.custom.i18n.resources" value="ApplicationResources" />
    
    <package name="default" extends="struts-default">
        
        <!-- Custom authentication interceptor is used to prevent users that are not logged in from performing actions -->
        <interceptors>
		    <interceptor name="customer-auth" class="com.bookstore.interceptor.CustomerLoginInterceptor"></interceptor>
		    <interceptor name="admin-auth" class="com.bookstore.interceptor.AdminLoginInterceptor"></interceptor>
		    <interceptor-stack name="customer-stack">
		        <interceptor-ref name="customer-auth"></interceptor-ref>
		        <interceptor-ref name="defaultStack"></interceptor-ref>
		    </interceptor-stack>
		    <interceptor-stack name="admin-stack">
		        <interceptor-ref name="admin-auth"></interceptor-ref>
		        <interceptor-ref name="defaultStack"></interceptor-ref>
		    </interceptor-stack>
		</interceptors>
		
        <global-results>
            <result name="login" type="redirect">index.jsp</result>
        </global-results>
        
        <!-- Register a new user NOTE: there is no interceptor on this method because the user will not be logged in -->
    	<action name="register" class="com.bookstore.view.CustomerController" method="register">
    		<result name="success">bookStoreHome.jsp</result>
    		<result name="error">index.jsp</result>
 		</action>
 		
    	<!-- Allow an existing user to log in -->
    	<action name="login" class="com.bookstore.view.CustomerController" method="login">
    		<result name="success">bookStoreHome.jsp</result>
    		<result name="error">index.jsp</result>
 		</action>
 		
    	<!-- Search Books -->
    	<action name="searchBooks" class="com.bookstore.view.BookController" method="searchBooks">
    		<result name="success">listBooks.jsp</result>
    		<result name="error">index.jsp</result>
 		</action>
 		
        <!-- Open the Categories Form -->
    	<action name="categoriesForm">
    		<!-- MUST BE AN ADMINISTRATOR INTERCEPTOR NEEDED -->
    		<result>categoryForm.jsp</result>
 		</action>
 		
    	<!-- Open the Books Form -->
    	<action name="booksForm" class="com.bookstore.view.BookController" method="listCategories">
    		<!-- MUST BE AN ADMINISTRATOR INTERCEPTOR NEEDED -->
    		<result name="success">bookForm.jsp</result>
 		</action>
 		
    	<!-- Persist New Category to Database -->
    	<action name="submitCategory" class="com.bookstore.view.CategoryController" method="addCategory">
    		<!-- MUST BE AN ADMINISTRATOR INTERCEPTOR NEEDED -->
    		<result name="success">administrationDashboard.jsp</result>
    		<result name="error">categoriesForm.jsp</result>
 		</action>
 		
    	<!-- Persist New Book to Database -->
    	<action name="submitBook" class="com.bookstore.view.BookController" method="addBook">
    		<!-- MUST BE AN ADMINISTRATOR INTERCEPTOR NEEDED -->
    		<result name="success">administrationDashboard.jsp</result>
    		<result name="error">categoriesForm.jsp</result>
 		</action>
 		
    	<!-- View a book -->
    	<action name="viewBook" class="com.bookstore.view.BookController" method="fetchBook">
    		<result name="success">viewBook.jsp</result>
 		</action>
 		
    	<!-- Add book to Cart -->
    	<action name="addToCart" class="com.bookstore.view.CartController" method="addToCart">
    		<result name="success">viewCart.jsp</result>
    		<result name="error">viewBook.jsp</result>
 		</action>
 		
    	<!-- Open Order Page -->
    	<action name="confirmOrder">
    		<interceptor-ref name="customer-auth"></interceptor-ref>
    		<result name="success">confirmOrder.jsp</result>
 		</action>
 		
    	<!-- A link to the home page of the shop -->
    	<action name="confirmOrder">
    		<result name="success">bookStoreHome.jsp</result>
 		</action>
    	
    	<!-- Open Order Page -->
    	<action name="placeOrder" class="com.bookstore.view.OrderController" method="placeOrder">
    		<!-- <interceptor-ref name="customer-auth"></interceptor-ref> -->
    		<result name="success">purchaseConfirmation.jsp</result>
 		</action>
 		
    	<!-- Leave a book review -->
    	<action name="addReview" class="com.bookstore.view.ReviewController" method="addReview">
    		<!-- <interceptor-ref name="customer-auth"></interceptor-ref> -->
    		<result name="success">viewBook.jsp</result>
 		</action>
        
    </package>
    
</struts>